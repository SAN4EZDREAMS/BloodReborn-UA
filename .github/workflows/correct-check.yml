name: Checking the correctness of IDs

on:
  workflow_call:

jobs:
  list-xml-ids:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Extract and validate XML IDs
        run: |
          error_found=false
          while IFS= read -r file; do
            echo "Checking file: $file"
            while IFS= read -r line; do
              if [[ $line =~ <text\ id=\"([^\"]+)\" ]]; then
                id="${BASH_REMATCH[1]}"
                if ! [[ "$id" =~ ^[0-9]+$ ]]; then
                  echo "ERROR: Non-numeric ID '$id' found in file '$file'"
                  error_found=true
                fi
              fi
            done < "$file"
            echo "---------------------"
          done < <(find . -type f -name "*.xml")

          if [ "$error_found" = true ]; then
            exit 1
          fi
